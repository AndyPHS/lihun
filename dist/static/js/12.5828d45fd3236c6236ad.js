webpackJsonp([12],{K31e:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o("lbHh");var r=o("A+nQ"),i={name:"login",data:()=>({permissions:[],permissionId:[],roles:[],rolesId:[],loginForm:{name:"",password:"",code:"",code_key:""},identifyCodeMsg:{type:"text",placeholder:"请输入验证码",value:"",codeUrl:"",widthClass:"vertical"},loginFormRules:{name:[{required:!0,message:"账号不可为空",trigger:"blur"}],password:[{required:!0,message:"密码不可为空",trigger:"blur"}],code:[{required:!0,message:"验证码不可为空",trigger:"blur"}]},verifyCode:"",ifShade:!1,denglu:"登录"}),mounted(){"questionnaireDemo"==localStorage.getItem("roleType")&&localStorage.removeItem("roleType"),this.changeCode()},methods:{loginSubmit(e){this.$refs[e].validate(e=>{if(!e)return this.errorAlert("重新登录"),!1;Object(r.C)(this.loginForm).then(e=>{if(200==e.data.status_code)localStorage.setItem("name",this.loginForm.name),localStorage.setItem("token",e.data.data.token),Object(r._3)().then(e=>{this.permissions=e.data.permissions,this.roles=e.data.roles,this.permissions!==[]&&(this.permissions.forEach(e=>{this.permissionId.push(e.id)}),this.roles.forEach(e=>{this.rolesId.push(e.name)}),this.rolesId.indexOf("questionnaireDemo")>-1?(localStorage.setItem("roleType","questionnaireDemo"),this.$router.replace("/UserSystem")):this.$router.replace("/FileList"))});else if(100==e.data.status_code)this.errorAlert(e.data.message);else{if(102!=e.data.status_code)return;this.errorAlert(e.data.message)}}).catch(e=>{this.errorAlert("密码或验证码错误，请重试"),100==e.data.status_code?this.errorAlert("验证码错误"):102==e.data.status_code&&this.errorAlert("密码错误")})})},errorAlert(e){this.$message.error(e)},changeCode(e){Object(r._4)({cache:(new Date).getTime()}).then(e=>{this.identifyCodeMsg.codeUrl=e.data.img,this.loginForm.code_key=e.data.key}),this.identifyCodeMsg.codeUrl=e}}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login-box"},[o("el-form",{ref:"loginForm",attrs:{rules:e.loginFormRules,model:e.loginForm,"label-position":"right","label-width":"auto","show-message":""}},[o("span",{staticClass:"login-title text-xl"},[e._v("欢迎登录")]),e._v(" "),o("div",{staticStyle:{"margin-top":"5px"}}),e._v(" "),o("el-form-item",{attrs:{label:"用户名",prop:"name"}},[o("el-col",{attrs:{span:22}},[o("el-input",{attrs:{type:"text"},model:{value:e.loginForm.name,callback:function(t){e.$set(e.loginForm,"name",t)},expression:"loginForm.name"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"密码",prop:"password"}},[o("el-col",{attrs:{span:22}},[o("el-input",{attrs:{type:"password"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"验证码",prop:"code"}},[o("el-col",{attrs:{span:22}},[o("el-input",{attrs:{type:e.identifyCodeMsg.type,placeholder:e.identifyCodeMsg.placeholder},on:{changeCode:e.changeCode},model:{value:e.loginForm.code,callback:function(t){e.$set(e.loginForm,"code",t)},expression:"loginForm.code"}}),e._v(" "),o("div",{staticClass:"vertical_code_block clear"},[o("div",{staticClass:"vertical_code_item vertical_code_figure",attrs:{id:"v_container"},on:{click:e.changeCode}},[o("img",{key:e.loginForm.code_key,attrs:{src:e.identifyCodeMsg.codeUrl,alt:""}})])])],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},domProps:{innerHTML:e._s(e.denglu)},on:{click:function(t){return e.loginSubmit("loginForm")}}},[e._v(e._s(e.denglu))])],1)],1)],1)},staticRenderFns:[]};var s=o("VU/8")(i,n,!1,function(e){o("sLQv")},"data-v-6c97674f",null);t.default=s.exports},lbHh:function(e,t,o){var r,i;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(n){if(void 0===(i="function"==typeof(r=n)?r.call(t,o,t,e):r)||(e.exports=i),!0,e.exports=n(),!!0){var s=window.Cookies,a=window.Cookies=n();a.noConflict=function(){return window.Cookies=s,a}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var o=arguments[e];for(var r in o)t[r]=o[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function o(r){function i(){}function n(t,o,n){if("undefined"!=typeof document){"number"==typeof(n=e({path:"/"},i.defaults,n)).expires&&(n.expires=new Date(1*new Date+864e5*n.expires)),n.expires=n.expires?n.expires.toUTCString():"";try{var s=JSON.stringify(o);/^[\{\[]/.test(s)&&(o=s)}catch(e){}o=r.write?r.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var l in n)n[l]&&(a+="; "+l,!0!==n[l]&&(a+="="+n[l].split(";")[0]));return document.cookie=t+"="+o+a}}function s(e,o){if("undefined"!=typeof document){for(var i={},n=document.cookie?document.cookie.split("; "):[],s=0;s<n.length;s++){var a=n[s].split("="),l=a.slice(1).join("=");o||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=t(a[0]);if(l=(r.read||r)(l,c)||t(l),o)try{l=JSON.parse(l)}catch(e){}if(i[c]=l,e===c)break}catch(e){}}return e?i[e]:i}}return i.set=n,i.get=function(e){return s(e,!1)},i.getJSON=function(e){return s(e,!0)},i.remove=function(t,o){n(t,"",e(o,{expires:-1}))},i.defaults={},i.withConverter=o,i}(function(){})})},sLQv:function(e,t){}});
//# sourceMappingURL=12.5828d45fd3236c6236ad.js.map